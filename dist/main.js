(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var i=t.g.document;if(!e&&i&&(i.currentScript&&(e=i.currentScript.src),!e)){var n=i.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();var e=function(){function t(t){var e=this;this.game=t,this.paths={loadingWrapper:void 0},this.processing=0,this.lazyProcessing=0,this.percentage=void 0,this.loadingDrawParametrs={bottom:t.windowSize.height-t.windowSize.height/100*17,width:t.windowSize.width/100*80,left:t.windowSize.width/100*10,lineThickness:10,lineWidth:.5},this.defaultLoaders=[function(){return e.game.loadImages("./images/search.png","searchIcon")},function(){return e.game.loadImages("./images/franceLocal.jpg","locationFrance")},function(){return e.game.loadImages("./images/egipetLocal.jpg","locationEgipet")},function(){return new Promise((function(t){return setTimeout((function(){return t(1)}),50)}))},function(){return new Promise((function(t){return setTimeout((function(){return t(2)}),100)}))},function(){return new Promise((function(t){return setTimeout((function(){return t(3)}),200)}))},function(){return new Promise((function(t){return setTimeout((function(){return t(4)}),300)}))}]}return t.prototype.init=function(t){void 0===t&&(t=this.defaultLoaders),this.game.setBackground("./images/loadingBg.jpg",!0),this.percentage=this.loadingDrawParametrs.width/100,this.loading(t),this.paintLoading(),this.loadingLoop()},t.prototype.loading=function(t){var e=this,i=100/t.length;Promise.all(t.map((function(t){return t().then((function(){return e.processing+=i}))})))},t.prototype.paintLoading=function(){if(!this.paths.loadingWrapper){var t=this.loadingDrawParametrs,e=t.left,i=t.bottom,n=t.width,a=t.lineThickness;this.paths.loadingWrapper=this.CreateRectangleBorderRadius(e,i,n,a)}this.paintDrawLoadingWrapper(),this.paintLoadingProcess()},t.prototype.loadingLoop=function(){var t=this;if(this.lazyProcessing<this.processing&&(this.lazyProcessing+=100),this.paintLoadingProcess(),this.lazyProcessing>=100)return this.game.setStatus("globalMenu");requestAnimationFrame((function(){return t.loadingLoop()}))},t.prototype.paintLoadingProcess=function(){if(!(this.processing<1)){var t=this.loadingDrawParametrs,e=t.left,i=t.bottom,n=t.lineThickness,a=t.lineWidth,o=this.game.mainContext,s=this.lazyProcessing*this.percentage,r=this.CreateRectangleBorderRadius(e,i,s,n-a-.5);o.beginPath(),o.fillStyle="#aebacd",o.fill(r)}},t.prototype.paintDrawLoadingWrapper=function(){var t=this.game.mainContext;t.beginPath(),t.fillStyle="#09082f",t.strokeStyle="#fff",t.lineWidth=this.loadingDrawParametrs.lineWidth,t.fill(this.paths.loadingWrapper),t.stroke(this.paths.loadingWrapper)},t.prototype.CreateRectangleBorderRadius=function(t,e,i,n){var a=new Path2D,o=n/2;return a.moveTo(t,e),a.quadraticCurveTo(t,e-o,t+o,e-o),a.lineTo(t+i-o,e-o),a.quadraticCurveTo(t+i,e-o,t+i,e),a.quadraticCurveTo(t+i,e+o,t+i-o,e+o),a.lineTo(t+o,e+o),a.quadraticCurveTo(t,e+o,t,e),a.closePath(),a},t}();const i=function(){function t(t){this.game=t,this.buttonPlayGradient=void 0,this.levelInfoGradient=void 0,this.locationParams={x:0,y:0,r:0,width:40,height:40},this.textPlayParametrs={bottom:0,left:0,fs:0},this.locationImg=void 0,this.paths={playButton:void 0,levelInfo:void 0,locationIcon:void 0},this.mainClick=this.mainClick.bind(this),this.menuMouseMove=this.menuMouseMove.bind(this)}return t.prototype.init=function(){this.game.clearMainCanvas(),this.game.setBackground("./images/loadingBg.jpg",!0),this.paths.playButton||(this.paths.playButton=this.createPathButtonPlay()),this.paths.levelInfo||(this.paths.levelInfo=this.createPathLevelInfo()),this.paths.locationIcon||(this.paths.locationIcon=this.createPathLocation()),this.game.screenWrapper.addEventListener("click",this.mainClick),this.game.screenWrapper.addEventListener("mousemove",this.menuMouseMove),this.menuLoop()},t.prototype.menuMouseMove=function(t){for(var e=this.game,i=e.mainContext,n=e.screenWrapper,a=this.game.getCursorPosition(t),o=a.x,s=a.y,r=0,h=Object.entries(this.paths);r<h.length;r++){var l=h[r],c=(l[0],l[1]);if(i.isPointInPath(c,o,s)){n.style.cursor="pointer";break}n.style.cursor="default"}},t.prototype.mainClick=function(t){for(var e=t.offsetX,i=t.offsetY,n=this.game.mainContext,a=0,o=Object.entries(this.paths);a<o.length;a++){var s=o[a],r=s[0],h=s[1],l=r+"OnClick";n.isPointInPath(h,e,i)&&this[l]()}},t.prototype.locationIconOnClick=function(){this.game.setStatus("location")},t.prototype.menuLoop=function(){var t=this;if("globalMenu"!==this.game.status){var e=this.game.screenWrapper;return e.removeEventListener("click",this.mainClick),void e.removeEventListener("mousemove",this.menuMouseMove)}this.game.clearMainCanvas(),this.paintButtonPlay(),this.paintLevelInfo(),this.paintLocation(),requestAnimationFrame((function(){return t.menuLoop()}))},t.prototype.paintButtonPlay=function(){var t=this.game.mainContext,e=this.textPlayParametrs,i=e.left,n=e.bottom,a=e.fs;t.beginPath(),t.fillStyle=this.buttonPlayGradient,t.fill(this.paths.playButton),t.beginPath(),t.font="500 "+a+"px Roboto",t.textBaseline="middle",t.textAlign="center",t.fillStyle="#fff",t.fillText("ИГРАТЬ",i,n)},t.prototype.createPathButtonPlay=function(){var t=this.game.windowSize,e=t.width,i=t.height,n=this.game.minMax(e/100*60,300,550),a=e/2-n/2,o=this.game.minMax(i/100*10,45,55),s=i/100*70,r=o/2,h=new Path2D;this.textPlayParametrs.bottom=s+4,this.textPlayParametrs.left=e/2,this.textPlayParametrs.fs=o-25,h.moveTo(a,s),h.quadraticCurveTo(a,s-r,a+r,s-r),h.lineTo(a+n-r,s-r),h.quadraticCurveTo(a+n,s-r,a+n,s),h.quadraticCurveTo(a+n,s+r,a+n-r,s+r),h.lineTo(a+r,s+r),h.quadraticCurveTo(a,s+r,a,s);var l=this.game.mainContext.createLinearGradient(a,s,a+n,s);return l.addColorStop(0,"#f46a49"),l.addColorStop(1,"#f652a8"),this.buttonPlayGradient=l,h},t.prototype.createPathLevelInfo=function(){var t=new Path2D,e=this.game.mainContext,i=this.game.windowSize,n=i.width,a=i.height,o=this.game.minMax(Math.min(n,a)/100*10,100,140),s=n/2,r=a/100*45,h=e.createLinearGradient(s+o,r-o,s+o,r+o);return h.addColorStop(0,"#697af3"),h.addColorStop(1,"#7d42d1"),this.levelInfoGradient=h,t.arc(s,r,o,0,2*Math.PI),t},t.prototype.createPathLocation=function(){var t=new Path2D,e=this.game.windowSize.width-60;return t.arc(e+20,40,20,0,2*Math.PI),this.locationParams.x=e,this.locationParams.y=20,this.locationParams.r=20,this.locationImg=new Image(this.locationParams.width,this.locationParams.height),this.locationImg.src="./images/location.png",t},t.prototype.paintLocation=function(){var t=this.game.mainContext,e=this.locationParams,i=e.x,n=e.y,a=e.width,o=e.height,s=this.locationImg;t.beginPath(),t.fillStyle="transparent",t.fill(this.paths.locationIcon),t.beginPath(),t.drawImage(s,i,n,a,o)},t.prototype.paintLevelInfo=function(){var t=this.paths.levelInfo,e=this.game.mainContext;e.save(),e.beginPath(),e.shadowColor="#f8f9d6",e.shadowBlur=50,e.fillStyle=this.levelInfoGradient,e.fill(t),e.restore()},t}(),n=function(){function t(t){this.game=t,this.headingGradient=void 0,this.animateFrameId=void 0,this.headingHeight=60,this.backPath=void 0,this.fullHeightLevels=void 0,this.scrolTop=0,this.cardSize={width:this.game.minMax(300,this.game.windowSize.width/100*50,500),height:250},this.locationActivePaths=[],this.cardBottomPadding=15,this.heightVisibleDivision=this.game.windowSize.height-this.headingHeight,this.mouseMove=this.mouseMove.bind(this),this.click=this.click.bind(this),this.scrollLocationCard=this.scrollLocationCard.bind(this)}return t.prototype.fillBackground=function(){var t=this.game,e=t.backgroundContext,i=t.windowSize,n=i.width,a=i.height;e.beginPath(),e.fillStyle="#606fe4",e.fillRect(0,0,n,a)},t.prototype.paintHeader=function(){var t=this.game.mainContext,e=this.headingHeight,i=this.game.windowSize.width;t.save(),t.beginPath(),t.fillStyle=this.headingGradient,t.shadowColor="#3a4c8d",t.shadowOffsetY=0,t.shadowBlur=15,t.fillRect(0,0,i,e),t.font="500 24px Roboto",t.textBaseline="middle",t.textAlign="center",t.fillStyle="#fff",t.fillText("ИССЛЕДОВАТЬ",this.game.windowSize.width/2,this.headingHeight/2),t.beginPath(),t.lineWidth=5,t.lineCap="round",t.strokeStyle="#fff",t.stroke(this.backPath),t.restore()},t.prototype.createBackPath=function(){var t=new Path2D;return t.moveTo(35,15),t.lineTo(20,30),t.lineTo(35,45),t},t.prototype.mouseMove=function(t){var e=this.game.getCursorPosition(t),i=e.x,n=e.y,a=this.game.mainContext;this.game.screenWrapper.style.cursor=a.isPointInPath(this.backPath,i,n)?"pointer":"default"},t.prototype.click=function(t){var e=this.game.getCursorPosition(t),i=e.x,n=e.y;this.game.mainContext.isPointInPath(this.backPath,i,n)&&(cancelAnimationFrame(this.animateFrameId),this.clearEventListeners(),this.game.setStatus("globalMenu"))},t.prototype.scrollLocationCard=function(t){if(this.scrolTop+=t.deltaY/7,this.scrolTop>0)return this.scrolTop=0;var e=this.fullHeightLevels-(window.innerHeight-this.headingHeight);e<Math.abs(this.scrolTop)&&(this.scrolTop=-e)},t.prototype.clearEventListeners=function(){var t=this.game.screenWrapper;t.removeEventListener("mousemove",this.mouseMove),t.removeEventListener("click",this.click),t.style.cursor="default"},t.prototype.locationLoop=function(){var t=this;this.game.clearMainCanvas(),this.getVisibleCard(),this.paintHeader(),this.animateFrameId=requestAnimationFrame((function(){return t.locationLoop()}))},t.prototype.getVisibleCard=function(){var t=this,e=this.scrolTop,i=this.headingHeight,n=this.cardBottomPadding,a=this.cardSize.height,o=this.game.user.levels.countries,s=-a+i,r=window.innerHeight,h=(this.game.windowSize.width-this.cardSize.width)/2;o.reduce((function(e,o,l){var c=e+(l?a+n:i)+5;return c>r||c<s||(t.paintCard(c,h,a,o),t.paintSections(c,h+20,o)),c}),e)},t.prototype.paintCard=function(t,e,i,n){var a=this.game.mainContext,o=this.cardSize.width,s=this.createRect(e,t,o,i,15);a.save(),a.beginPath(),a.clip(s),a.drawImage(this.game.imagesStore[n.imageName],e,t,o,i),a.restore()},t.prototype.paintSections=function(t,e,i){var n=this,a=this.game.mainContext;a.font="11px roboto",a.textAlign="left",i.sights.reduce((function(t,i){var o=n.createRect(e+10,t,130,25,12.5);return a.fillStyle="#ea5c01",a.fill(o),a.fillStyle="#fff",a.fillText(i.title,e+10+7,t+12.5,90),a.drawImage(n.game.imagesStore.searchIcon,e+10+130-12-10,t+6.5,12,12),t+25+10}),t+20)},t.prototype.createRect=function(t,e,i,n,a){var o=new Path2D;return o.moveTo(t+a,e),o.lineTo(t+i-a,e),o.quadraticCurveTo(t+i,e,t+i,e+a),o.lineTo(t+i,e+n-a),o.quadraticCurveTo(t+i,e+n,t+i-a,e+n),o.lineTo(t+a,e+n),o.quadraticCurveTo(t,e+n,t,e+n-a),o.lineTo(t,e+a),o.quadraticCurveTo(t,e,t+a,e),o},t.prototype.init=function(){if(this.fillBackground(),!this.headingGradient){var t=this.game.mainContext.createLinearGradient(0,0,0,this.headingHeight);t.addColorStop(0,"#6571dd"),t.addColorStop(1,"#394d90"),this.headingGradient=t}this.fullHeightLevels||(this.fullHeightLevels=this.game.user.levels.countries.length*(this.cardSize.height+20)),this.backPath||(this.backPath=this.createBackPath()),this.game.screenWrapper.addEventListener("mousemove",this.mouseMove),this.game.screenWrapper.addEventListener("click",this.click),document.addEventListener("wheel",this.scrollLocationCard),this.locationLoop()},t}();var a=function(){function t(){this.countries=[{country:"ЕГИПЕТ",imageName:"locationEgipet",status:"done",sights:[{title:"ПИРАМИДЫ ГИЗЫ",status:"",levels:[{words:["Сон","Нос"],letters:["C","О","Н"]}]},{title:"БОЛЬШОЙ СФИНКС",status:"",levels:[{words:["Сон","Нос"],letters:["C","О","Н"]}]},{title:"КРАСНОЕ МОРЕ",status:"",levels:[{words:["Сон","Нос"],letters:["C","О","Н"]}]}]},{country:"египет",imageName:"locationFrance",status:"done",sights:[{title:"Пирамиды гизы",status:"",levels:[{words:["Сон","Нос"],letters:["C","О","Н"]}]}]}]}return t.prototype.getLevel=function(t){return this.countries[t]},t}(),o=function(t){this.game=t,this.level=0,this.levels=new a},s=function(){function t(){this.canvasBackground=void 0,this.screenWrapper=void 0,this.canvasMain=void 0,this.backgroundContext=void 0,this.mainContext=void 0,this.location=void 0,this.user=void 0,this.windowSize={width:0,height:0},this.imagesStore={},this.status="loadingTheGame",this.loadingGameStages=void 0,this.globalMenu=void 0}return t.prototype.init=function(){this.canvasBackground=document.querySelector("#canvas-bg"),this.canvasMain=document.querySelector("#canvas-main"),this.backgroundContext=this.canvasBackground.getContext("2d"),this.mainContext=this.canvasMain.getContext("2d"),this.screenWrapper=document.querySelector(".screen"),this.user=new o(this),this.setFullSize(),this.loadingGameStages=new e(this),this.globalMenu=new i(this),this.location=new n(this),this.runInitScene()},t.prototype.setStatus=function(t){this.status=t,this.runInitScene()},t.prototype.setFullSize=function(){var t=document.querySelector(".screen"),e=t.clientWidth,i=t.clientHeight;this.windowSize.width=e,this.windowSize.height=i;for(var n=0,a=[this.canvasBackground,this.canvasMain];n<a.length;n++){var o=a[n];o.width=e,o.height=i}},t.prototype.runInitScene=function(){switch(this.status){case"loadingTheGame":this.loadingGameStages.init();break;case"globalMenu":this.globalMenu.init();break;case"location":this.location.init()}},t.prototype.clearMainCanvas=function(){var t=this.mainContext;t.beginPath(),t.clearRect(0,0,this.windowSize.width,this.windowSize.height)},t.prototype.loadImages=function(t,e){var i=this,n=new Image(2e3,2e3);return new Promise((function(a,o){n.src=t,n.onload=function(){return i.imagesStore[e]=n,a(n)}}))},t.prototype.setBackground=function(t,e){var i=new Image,n=this.backgroundContext,a=this.windowSize,o=a.width,s=a.height;i.src=t,i.onload=function(){if(o>=s?n.drawImage(i,0,0,o,s*(o/s)):n.drawImage(i,0,0,o*(s/o),s),e){var t=o/2,a=s/100*15;n.beginPath(),n.font="500 40px Roboto",n.textBaseline="middle",n.textAlign="center",n.fillStyle="#fff",n.fillText("Words of wonders",t,a)}}},t.prototype.getCursorPosition=function(t){return{x:t.offsetX,y:t.offsetY}},t.prototype.minMax=function(t,e,i){return t>e&&i>t?t:t>i?i:t<e?e:void 0},t}();window.addEventListener("load",(function(){(new s).init()}),!1),t.p,t.p,t.p,t.p,t.p})();